<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSI3540 - Lab 3</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>

  <body class="min-h-screen bg-neutral-100 text-neutral-900">
    <main class="min-h-screen flex items-center justify-center p-6">
      <div class="w-full max-w-xl text-center">
        <h1 class="text-2xl font-bold">CSI3540 - Lab 3</h1>
        <p class="mt-1 text-sm text-neutral-600">
          All hosted code for this lab. Click the blue link to open the HTML
          page, and use <br />
          “Show CSS” to view the stylesheet files.
        </p>

        <div class="mt-5">
          <input
            id="search"
            type="text"
            placeholder="Search (ex: 3.1, 3.2...)"
            class="w-full rounded border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-neutral-500"
          />
        </div>

        <div class="mt-4 rounded border border-neutral-300 bg-white p-4 text-left">
          <p class="font-semibold">Pages</p>

          <ul id="list" class="mt-3 space-y-2 text-sm">
            <li class="text-neutral-500">Loading...</li>
          </ul>

          <p id="status" class="mt-4 text-xs text-neutral-500"></p>
        </div>
      </div>
    </main>

    <script>
      const SITE_MAP = {
        pages: [
          {
            title: "3.2 / Index.Xhtml",
            href: "./Book/3.2/index.xhtml",
            css: [
              "./Book/3.2/styles/print.css",
              "./Book/3.2/styles/style1.css",
              "./Book/3.2/styles/style2.css",
            ],
          },
          {
            title: "Book / 3.1",
            href: "./Book/3.1/index.html",
            css: ["./Book/3.1/main.css"],
          },
          {
            title: "Book / 3.3",
            href: "./Book/3.3/index.html",
            css: [],
          },
        ],
      };

      const list = document.getElementById("list");
      const status = document.getElementById("status");
      const search = document.getElementById("search");

      let pages = SITE_MAP.pages || [];

      function render() {
        const q = search.value.trim().toLowerCase();

        const filtered = pages.filter((p) => {
          const hay = `${p.title} ${p.href}`.toLowerCase();
          return hay.includes(q);
        });

        list.innerHTML = "";

        if (filtered.length === 0) {
          list.innerHTML = `<li class="text-neutral-500">No results.</li>`;
          status.textContent = "0 pages shown";
          return;
        }

        for (const p of filtered) {
          const cssArr = p.css || [];

          const cssList = cssArr
            .map(
              (c) => `
                <li class="ml-4 list-disc">
                  <a href="${c}" class="text-blue-700 underline hover:text-blue-900">${c}</a>
                </li>
              `
            )
            .join("");

          const li = document.createElement("li");

          li.innerHTML = `
            <div class="rounded border border-neutral-200 bg-neutral-50 p-3">
              <a href="${p.href}" class="text-blue-700 underline hover:text-blue-900 font-semibold">
                ${p.title}
              </a>
              <div class="text-xs text-neutral-500 mt-1">${p.href}</div>

              ${
                cssArr.length === 0
                  ? ""
                  : `
                    <details class="mt-2">
                      <summary class="cursor-pointer text-sm text-neutral-700">
                        Show CSS (${cssArr.length})
                      </summary>
                      <ul class="mt-2 text-sm">${cssList}</ul>
                    </details>
                  `
              }
            </div>
          `;

          list.appendChild(li);
        }

        status.textContent = `${filtered.length} page(s) shown`;
      }

      search.addEventListener("input", render);
      render();
    </script>
  </body>
</html>
